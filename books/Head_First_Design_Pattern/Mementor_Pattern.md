# 备忘录模式（ Mememto Pattern ）

# 1 定义

> 当需要让对象返回之前的状态（例如，用户请求：“撤销”），就可以使用备忘录模式

- 角色

| 角色                 | DESC                                             |
| -------------------- | ------------------------------------------------ |
| Originator（发起人） | 是一个关键对象。创建一个备忘录，并存储它当前状态 |
| Memento(备忘录)      | 专门掌握关键对象的状态：存储 Originator 中的状态 |
| Caretaker(管理者)    | 保存备忘录，只存储、不修改对象                   |

- 实际中三个角色的名字可以任意。
- 读档  
  ![Mememto_Pattern](https://yingvickycao.github.io/img/Mememto_Pattern.png)

# 2 场景

游戏允许玩家“存储进度”，当角色死在游戏时，通过读档：复活角色，进度停留在上一次过关的关卡上。

## 实际应用

- 游戏存档
- Git 版本管理
- 浏览器 Back
- 数据库的备份与还原、事务管理
- 编辑软件的 Ctrl + Z
- Windows / Mac 的 Ctrl + Z

# 3 How to use

## 使用备忘录

备忘录模式有 2 个目标：

- 存储系统关键对象的重要状态
- 维护关键对象的封装

# 4 优点

- 把被存储的状态放在外面，不要和关键对象混在一起，这样可以帮助维护内聚
- 保持关键对象的数据封装
- 提供了容易实现的恢复能力

# 5 用途

- 备忘录用于存储状态

# 6 缺点

- 存储和恢复状态的过程可能相当耗时  
  为了节约内存，可使用原型模式+备忘录模式
- 在 Java 系统中，其实可以考虑使用 序列化(serialization)机制 存储系统的状态

# Refs

- https://www.runoob.com/design-pattern/memento-pattern.html
